{"version":3,"sources":["../../src/Controller/IndexController.js"],"names":["IndexController","constructor","args","logger","Logger","start","callback","event","progress","Promise","resolve","reject","output","doesFolderExist","crawlService","CrawlService","on","report","toLog","verbose","console","log","toString","isSeedWithSitemap","sitemapService","SitemapService","count"],"mappings":";;;;;;;AACA;;AACA;;AAEA;;AACA;;;;AAEe,MAAMA,eAAN,CAAsB;AAIjCC,EAAAA,WAAW,CAACC,IAAD,EAAa;AACpB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAKC,MAAL,GAAc,IAAIC,eAAJ,CAAWF,IAAX,CAAd;AACH;;AAEDG,EAAAA,KAAK,GACa;AAAA,QADZC,QACY,uEADS,CAACC,KAAD,EAAQC,QAAR,KAAqB,CAC/C,CAAiB;AACd,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,WAAKT,IAAL,CAAUU,MAAV,CAAiBC,eAAjB;AAEA,UAAIC,YAAY,GAAG,IAAIC,qBAAJ,CAAiB,KAAKb,IAAtB,CAAnB;AACAY,MAAAA,YAAY,CACPE,EADL,CACQ,UADR,EACoBR,QAAQ,IAAI;AACxBF,QAAAA,QAAQ,CAAC,UAAD,EAAaE,QAAb,CAAR;AACA,aAAKL,MAAL,CAAYc,MAAZ,CAAmBT,QAAQ,CAACU,KAAT,EAAnB;;AACA,YAAI,KAAKhB,IAAL,CAAUiB,OAAd,EAAuB;AACnBC,UAAAA,OAAO,CAACC,GAAR,CAAYb,QAAQ,CAACc,QAAT,EAAZ;AACH;AACJ,OAPL,EAQKN,EARL,CAQQ,UARR,EAQoB,MAAM;AAClBV,QAAAA,QAAQ,CAAC,UAAD,CAAR;;AACA,YAAI,KAAKJ,IAAL,CAAUiB,OAAd,EAAuB;AACnBC,UAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ;AACH;;AACDX,QAAAA,OAAO;AACV,OAdL;;AAeA,UAAG,KAAKR,IAAL,CAAUqB,iBAAV,EAAH,EAAkC;AAC9B,YAAIC,cAAc,GAAG,IAAIC,uBAAJ,CAAmB,KAAKvB,IAAxB,CAArB;AACAsB,QAAAA,cAAc,CACTR,EADL,CACQ,UADR,EACoBR,QAAQ,IAAI;AACxBF,UAAAA,QAAQ,CAAC,UAAD,EAAaE,QAAb,CAAR;AACA,eAAKL,MAAL,CAAYc,MAAZ,CAAmBT,QAAQ,CAACU,KAAT,EAAnB;;AACA,cAAI,KAAKhB,IAAL,CAAUiB,OAAd,EAAuB;AACnBC,YAAAA,OAAO,CAACC,GAAR,oBAAwBb,QAAQ,CAACc,QAAT,EAAxB;AACH;AACJ,SAPL,EAQKN,EARL,CAQQ,UARR,EAQqBU,KAAD,IAAW;AACvBpB,UAAAA,QAAQ,CAAC,UAAD,CAAR;;AACA,cAAI,KAAKJ,IAAL,CAAUiB,OAAd,EAAuB;AACnBC,YAAAA,OAAO,CAACC,GAAR,gDAAoDK,KAApD;AACH;;AACDZ,UAAAA,YAAY,CAACT,KAAb;AACH,SAdL;AAeAmB,QAAAA,cAAc,CAACnB,KAAf;AACH,OAlBD,MAkBO;AACHS,QAAAA,YAAY,CAACT,KAAb;AACH;AACJ,KAxCM,CAAP;AAyCH;;AApDgC","sourcesContent":["// @flow\nimport CrawlService from '../Service/CrawlService.js';\nimport SitemapService from '../Service/SitemapService.js';\n\nimport Logger from '../Utility/Logger.js';\nimport Args from '../Model/Args.js';\n\nexport default class IndexController {\n    args: Args;\n    logger: Logger;\n\n    constructor(args: Args) {\n        this.args = args;\n        this.logger = new Logger(args);\n    }\n\n    start(callback: function = (event, progress) => {\n    }): Promise<void> {\n        return new Promise((resolve, reject) => {\n            this.args.output.doesFolderExist();\n\n            let crawlService = new CrawlService(this.args);\n            crawlService\n                .on('progress', progress => {\n                    callback('progress', progress);\n                    this.logger.report(progress.toLog());\n                    if (this.args.verbose) {\n                        console.log(progress.toString());\n                    }\n                })\n                .on('complete', () => {\n                    callback('complete');\n                    if (this.args.verbose) {\n                        console.log('Done');\n                    }\n                    resolve();\n                });\n            if(this.args.isSeedWithSitemap()) {\n                let sitemapService = new SitemapService(this.args);\n                sitemapService\n                    .on('progress', progress => {\n                        callback('progress', progress);\n                        this.logger.report(progress.toLog());\n                        if (this.args.verbose) {\n                            console.log(`Seeding: ${progress.toString()}`);\n                        }\n                    })\n                    .on('complete', (count) => {\n                        callback('complete');\n                        if (this.args.verbose) {\n                            console.log(`Done Seeding. Starting the pool with ${count} urls.`);\n                        }\n                        crawlService.start();\n                    });\n                sitemapService.start();\n            } else {\n                crawlService.start();\n            }\n        });\n    }\n}\n"],"file":"IndexController.js"}