{"version":3,"sources":["../../src/Repository/OptionsRepository.js"],"names":["OptionsRepository","constructor","args","folder","createFolder","file","getSiteName","getOption","option","Option","JSON","parse","toString","OptionDefaults","save","stringify","optionsFolder","output","filename"],"mappings":"6FACA,sBACA,0BAEA,+DACA,qFACA,2D,kFAEA;;GAGe,KAAMA,CAAAA,iBAAkB,CACnC;;OADmC,CAKnC;;OALmC,CASnC;;OATmC,CAanC;;OAKAC,WAAW,CAACC,IAAD,CAAa,CACpB,KAAKA,IAAL,CAAYA,IAAZ,CACA,KAAKC,MAAL,CAAc,KAAKC,YAAL,EAAd,CACA,KAAKC,IAAL,CAAY,eAAK,KAAKF,MAAV,CAAkB,KAAKD,IAAL,CAAUI,WAAV,GAA0B,OAA5C,CACf,CAED;;OAGAC,SAAS,EAAW,CAChB,GAAI,KAAKC,MAAL,EAAe,IAAnB,CAAyB,CACrB,GAAI,mBAAW,KAAKH,IAAhB,CAAJ,CAA2B,CACvB,KAAKG,MAAL,CAAc,GAAIC,gBAAJ,CACVC,IAAI,CAACC,KAAL,CAAW,qBAAa,KAAKN,IAAlB,EAAwBO,QAAxB,EAAX,CADU,CAGjB,CAJD,IAIO,CACH,KAAKJ,MAAL,CAAc,GAAIC,gBAAJ,CAAWI,uBAAX,CAAd,CACA,KAAKC,IAAL,CAAU,KAAKN,MAAf,CACH,CACJ,CACD,MAAO,MAAKA,MACf,CAED;;OAGAM,IAAI,CAACN,MAAD,CAAiB,CACjB,sBAAc,KAAKH,IAAnB,CAAyBK,IAAI,CAACK,SAAL,CAAeP,MAAf,CAAuB,IAAvB,CAA6B,CAA7B,CAAzB,CACH,CAED;;OAGAJ,YAAY,EAAW,CACnB,KAAMY,CAAAA,aAAa,CAAG,eAAK,KAAKd,IAAL,CAAUe,MAAV,CAAiBC,QAAtB,CAAgC,SAAhC,CAAtB,CACA,GAAI,CAAC,mBAAWF,aAAX,CAAL,CAAgC,CAC5B,kBAAUA,aAAV,CACH,CACD,MAAOA,CAAAA,aACV,CAzDkC,C","sourcesContent":["// @flow\r\nimport {existsSync, readFileSync, writeFileSync, mkdirSync} from \"fs\";\r\nimport {join} from \"path\";\r\n\r\nimport Option from \"../Model/Option\";\r\nimport OptionDefaults from \"../Assets/OptionDefaults.json\";\r\nimport Args from \"../Model/Args\";\r\n\r\n/**\r\n * Save and load options for the index.\r\n */\r\nexport default class OptionsRepository {\r\n    /**\r\n     * Passed in from the command-line.\r\n     */\r\n    args: Args;\r\n    /**\r\n     * Folder where the options are saved.\r\n     */\r\n    folder: string;\r\n    /**\r\n     * Path to the options file.\r\n     */\r\n    file: string;\r\n    /**\r\n     * Options for the site indexing.\r\n     */\r\n    option: Option;\r\n\r\n    constructor(args: Args) {\r\n        this.args = args;\r\n        this.folder = this.createFolder();\r\n        this.file = join(this.folder, this.args.getSiteName() + \".json\");\r\n    }\r\n\r\n    /**\r\n     * Get the option from file or load defaults or load from memory.\r\n     */\r\n    getOption(): Option {\r\n        if (this.option == null) {\r\n            if (existsSync(this.file)) {\r\n                this.option = new Option(\r\n                    JSON.parse(readFileSync(this.file).toString())\r\n                );\r\n            } else {\r\n                this.option = new Option(OptionDefaults);\r\n                this.save(this.option);\r\n            }\r\n        }\r\n        return this.option;\r\n    }\r\n\r\n    /**\r\n     * Save the option to file.\r\n     */\r\n    save(option: Option) {\r\n        writeFileSync(this.file, JSON.stringify(option, null, 2));\r\n    }\r\n\r\n    /**\r\n     * Create the options folder.\r\n     */\r\n    createFolder(): string {\r\n        const optionsFolder = join(this.args.output.filename, \"options\");\r\n        if (!existsSync(optionsFolder)) {\r\n            mkdirSync(optionsFolder);\r\n        }\r\n        return optionsFolder;\r\n    }\r\n}\r\n"],"file":"OptionsRepository.js"}