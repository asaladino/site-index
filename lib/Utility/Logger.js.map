{"version":3,"sources":["../../src/Utility/Logger.js"],"names":["Logger","constructor","args","logsPath","getLogsPath","logger","level","format","_format","json","transports","_transports","File","filename","save","state","Promise","resolve","file","JSON","stringify","info","log","report","logsPathBase","getProjectPath"],"mappings":";;;;;;;AACA;;AAKA;;AACA;;AACA;;;;AAEe,MAAMA,MAAN,CAAa;AAK1BC,EAAAA,WAAW,CAACC,IAAD,EAAa;AACtB,SAAKA,IAAL,GAAYA,IAAZ;AACA,SAAKC,QAAL,GAAgB,KAAKC,WAAL,EAAhB;AACA,SAAKC,MAAL,GAAc,2BAAa;AACzBC,MAAAA,KAAK,EAAE,MADkB;AAEzBC,MAAAA,MAAM,EAAEC,gBAAQC,IAAR,EAFiB;AAGzBC,MAAAA,UAAU,EAAE,CACV,IAAIC,oBAAYC,IAAhB,CAAqB;AAAEC,QAAAA,QAAQ,EAAE,gBAAK,KAAKV,QAAV,EAAoB,cAApB;AAAZ,OAArB,CADU;AAHa,KAAb,CAAd;AAOD;;AAEDW,EAAAA,IAAI,CAACC,KAAD,EAA2B;AAC7B,WAAO,IAAIC,OAAJ,CAAYC,OAAO,IAAI;AAC5B,UAAIC,IAAI,GAAG,gBAAK,KAAKf,QAAV,EAAoB,YAApB,CAAX;AACA,6BAAce,IAAd,EAAoBC,IAAI,CAACC,SAAL,CAAeL,KAAf,CAApB;AACAE,MAAAA,OAAO;AACR,KAJM,CAAP;AAKD;;AAEDI,EAAAA,IAAI,CAACN,KAAD,EAAa;AACf,SAAKV,MAAL,CAAYiB,GAAZ,CAAgB,MAAhB,EAAwBH,IAAI,CAACC,SAAL,CAAeL,KAAf,CAAxB;AACD;;AAEDQ,EAAAA,MAAM,CAACR,KAAD,EAAa;AACjB,SAAKD,IAAL,CAAUC,KAAV;AACA,SAAKM,IAAL,CAAUN,KAAV;AACD;;AAEDX,EAAAA,WAAW,GAAW;AACpB,QAAIoB,YAAY,GAAG,gBAAK,KAAKtB,IAAL,CAAUuB,cAAV,EAAL,EAAiC,MAAjC,CAAnB;;AACA,QAAI,CAAC,oBAAWD,YAAX,CAAL,EAA+B;AAC7B,yBAAUA,YAAV;AACD;;AAED,QAAIrB,QAAQ,GAAG,gBAAK,KAAKD,IAAL,CAAUuB,cAAV,EAAL,EAAiC,MAAjC,EAAyC,OAAzC,CAAf;;AACA,QAAI,CAAC,oBAAWtB,QAAX,CAAL,EAA2B;AACzB,yBAAUA,QAAV;AACD;;AACD,WAAOA,QAAP;AACD;;AA7CyB","sourcesContent":["// @flow\nimport {\n  createLogger,\n  format as _format,\n  transports as _transports\n} from \"winston\";\nimport Args from \"../Model/Args\";\nimport { join } from \"path\";\nimport { writeFileSync, existsSync, mkdirSync } from \"fs\";\n\nexport default class Logger {\n  args: Args;\n  logsPath: string;\n  logger: any;\n\n  constructor(args: Args) {\n    this.args = args;\n    this.logsPath = this.getLogsPath();\n    this.logger = createLogger({\n      level: \"info\",\n      format: _format.json(),\n      transports: [\n        new _transports.File({ filename: join(this.logsPath, \"last_run.log\") })\n      ]\n    });\n  }\n\n  save(state: any): Promise<any> {\n    return new Promise(resolve => {\n      let file = join(this.logsPath, \"state.json\");\n      writeFileSync(file, JSON.stringify(state));\n      resolve();\n    });\n  }\n\n  info(state: any) {\n    this.logger.log(\"info\", JSON.stringify(state));\n  }\n\n  report(state: any) {\n    this.save(state);\n    this.info(state);\n  }\n\n  getLogsPath(): string {\n    let logsPathBase = join(this.args.getProjectPath(), \"logs\");\n    if (!existsSync(logsPathBase)) {\n      mkdirSync(logsPathBase);\n    }\n\n    let logsPath = join(this.args.getProjectPath(), \"logs\", \"index\");\n    if (!existsSync(logsPath)) {\n      mkdirSync(logsPath);\n    }\n    return logsPath;\n  }\n}\n"],"file":"Logger.js"}