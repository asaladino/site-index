{"version":3,"sources":["../../src/Utility/Logger.js"],"names":["Logger","constructor","args","logsPath","getLogsPath","logger","level","format","_format","json","transports","_transports","File","filename","save","state","Promise","resolve","file","JSON","stringify","info","log","report","logsPathBase","getProjectPath"],"mappings":"6FACA,gCAKA,2DACA,0BACA,sB,kFAEe,KAAMA,CAAAA,MAAO,CAKxBC,WAAW,CAACC,IAAD,CAAa,CACpB,KAAKA,IAAL,CAAYA,IAAZ,CACA,KAAKC,QAAL,CAAgB,KAAKC,WAAL,EAAhB,CACA,KAAKC,MAAL,CAAc,0BAAa,CACvBC,KAAK,CAAE,MADgB,CAEvBC,MAAM,CAAEC,gBAAQC,IAAR,EAFe,CAGvBC,UAAU,CAAE,CACR,GAAIC,qBAAYC,IAAhB,CAAqB,CAACC,QAAQ,CAAE,eAAK,KAAKV,QAAV,CAAoB,cAApB,CAAX,CAArB,CADQ,CAHW,CAAb,CAOjB,CAEDW,IAAI,CAACC,KAAD,CAA2B,CAC3B,MAAO,IAAIC,CAAAA,OAAJ,CAAYC,OAAO,EAAI,CAC1B,GAAIC,CAAAA,IAAI,CAAG,eAAK,KAAKf,QAAV,CAAoB,YAApB,CAAX,CACA,sBAAce,IAAd,CAAoBC,IAAI,CAACC,SAAL,CAAeL,KAAf,CAApB,EACAE,OAAO,EACV,CAJM,CAKV,CAEDI,IAAI,CAACN,KAAD,CAAa,CACb,KAAKV,MAAL,CAAYiB,GAAZ,CAAgB,MAAhB,CAAwBH,IAAI,CAACC,SAAL,CAAeL,KAAf,CAAxB,CACH,CAEDQ,MAAM,CAACR,KAAD,CAAa,CACf,KAAKD,IAAL,CAAUC,KAAV,EACA,KAAKM,IAAL,CAAUN,KAAV,CACH,CAEDX,WAAW,EAAW,CAClB,GAAIoB,CAAAA,YAAY,CAAG,eAAK,KAAKtB,IAAL,CAAUuB,cAAV,EAAL,CAAiC,MAAjC,CAAnB,CACA,GAAI,CAAC,mBAAWD,YAAX,CAAL,CAA+B,CAC3B,kBAAUA,YAAV,CACH,CAED,GAAIrB,CAAAA,QAAQ,CAAG,eAAK,KAAKD,IAAL,CAAUuB,cAAV,EAAL,CAAiC,MAAjC,CAAyC,OAAzC,CAAf,CACA,GAAI,CAAC,mBAAWtB,QAAX,CAAL,CAA2B,CACvB,kBAAUA,QAAV,CACH,CACD,MAAOA,CAAAA,QACV,CA7CuB,C","sourcesContent":["// @flow\nimport {\n    createLogger,\n    format as _format,\n    transports as _transports\n} from \"winston\";\nimport Args from \"../Model/Args\";\nimport {join} from \"path\";\nimport {writeFileSync, existsSync, mkdirSync} from \"fs\";\n\nexport default class Logger {\n    args: Args;\n    logsPath: string;\n    logger: any;\n\n    constructor(args: Args) {\n        this.args = args;\n        this.logsPath = this.getLogsPath();\n        this.logger = createLogger({\n            level: \"info\",\n            format: _format.json(),\n            transports: [\n                new _transports.File({filename: join(this.logsPath, \"last_run.log\")})\n            ]\n        });\n    }\n\n    save(state: any): Promise<any> {\n        return new Promise(resolve => {\n            let file = join(this.logsPath, \"state.json\");\n            writeFileSync(file, JSON.stringify(state));\n            resolve();\n        });\n    }\n\n    info(state: any) {\n        this.logger.log(\"info\", JSON.stringify(state));\n    }\n\n    report(state: any) {\n        this.save(state);\n        this.info(state);\n    }\n\n    getLogsPath(): string {\n        let logsPathBase = join(this.args.getProjectPath(), \"logs\");\n        if (!existsSync(logsPathBase)) {\n            mkdirSync(logsPathBase);\n        }\n\n        let logsPath = join(this.args.getProjectPath(), \"logs\", \"index\");\n        if (!existsSync(logsPath)) {\n            mkdirSync(logsPath);\n        }\n        return logsPath;\n    }\n}\n"],"file":"Logger.js"}